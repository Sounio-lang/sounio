//! Example Test File
//!
//! Demonstrates the Sounio test framework.
//!
//! Run with: dc test examples/test_example.d

use test::*

// ==================== Basic Tests ====================

#[test]
fn test_arithmetic() {
    assert_eq(2 + 2, 4)
    assert_eq(10 - 3, 7)
    assert_eq(6 * 7, 42)
}

#[test]
fn test_boolean_logic() {
    assert_true(true)
    assert_false(false)
    assert_true(true && true)
    assert_false(true && false)
    assert_true(true || false)
}

#[test]
fn test_comparison() {
    assert_ne(1, 2)
    assert_eq(5, 5)
}

// ==================== Floating Point Tests ====================

#[test]
fn test_float_exact() {
    assert_eq(1.0 + 1.0, 2.0)
}

#[test]
fn test_float_approx() {
    // 0.1 + 0.2 is not exactly 0.3 due to floating point representation
    let result = 0.1 + 0.2
    assert_approx(result, 0.3)
}

#[test]
fn test_float_epsilon() {
    assert_approx_eps(1.0, 1.0001, 0.001)
}

#[test]
fn test_in_range() {
    assert_in_range(5, 1, 10)
    assert_in_range(1, 1, 10)  // inclusive
    assert_in_range(10, 1, 10) // inclusive
}

// ==================== Option/Result Tests ====================

#[test]
fn test_option_some() {
    let opt: Option<i32> = Some(42)
    assert_some(opt)
    assert_some_eq(opt, 42)
}

#[test]
fn test_option_none() {
    let opt: Option<i32> = None
    assert_none(opt)
}

#[test]
fn test_result_ok() {
    let res: Result<i32, string> = Ok(42)
    assert_ok(res)
    assert_ok_eq(res, 42)
}

#[test]
fn test_result_err() {
    let res: Result<i32, string> = Err("error")
    assert_err(res)
}

// ==================== Collection Tests ====================

#[test]
fn test_vec_operations() {
    let v = vec![1, 2, 3, 4, 5]

    assert_not_empty(&v)
    assert_len(&v, 5)
    assert_contains(&v, &3)
    assert_not_contains(&v, &10)
}

#[test]
fn test_empty_vec() {
    let v: Vec<i32> = Vec.new()
    assert_empty(&v)
}

#[test]
fn test_slice_equality() {
    let a = [1, 2, 3]
    let b = [1, 2, 3]
    assert_eq_elements(&a, &b)
}

// ==================== String Tests ====================

#[test]
fn test_string_contains() {
    let s = "Hello, World!"
    assert_str_contains(&s, "World")
    assert_str_contains(&s, "Hello")
}

#[test]
fn test_string_prefix_suffix() {
    let s = "Hello, World!"
    assert_starts_with(&s, "Hello")
    assert_ends_with(&s, "World!")
}

// ==================== Ignored Tests ====================

#[test]
#[ignore]
fn test_slow_operation() {
    // This test is skipped by default
    // Run with: dc test --include-ignored
    for i in 0..1000000 {
        let _ = i * i
    }
}

#[test]
#[ignore("Known issue #123")]
fn test_known_bug() {
    // Skipped with explanation
    assert_eq(1, 2) // Would fail
}

// ==================== Panic Tests ====================

#[test]
#[should_panic]
fn test_panic_occurs() {
    panic("This panic is expected")
}

#[test]
#[should_panic("expected")]
fn test_panic_message() {
    panic("This contains the expected message")
}

// ==================== Helper Functions ====================

fn helper_add(a: i32, b: i32) -> i32 {
    a + b
}

#[test]
fn test_helper_function() {
    assert_eq(helper_add(2, 3), 5)
    assert_eq(helper_add(-1, 1), 0)
    assert_eq(helper_add(0, 0), 0)
}

// ==================== Main (for running examples) ====================

fn main() {
    println("Run this file with: dc test examples/test_example.d")
    println("Or run all tests with: dc test")
}
