// Darwin Atlas Operators - Sounio Version
// Genomic sequence operators forming the dihedral group D_n

// Type aliases
type Base = u8;
type Sequence = [Base];

// Circular shift: rotate sequence by k positions
fn shift(seq: &[u8], n: i32, k: i32) -> [u8] {
    // seq[k..] ++ seq[..k]
    let tail = seq[k..]
    let head = seq[..k]
    return tail ++ head
}

// Reverse a sequence
fn reverse_seq(seq: &[u8]) -> [u8] {
    return seq.reverse()
}

// Complement a single base (XOR with 0b11)
fn complement_base(b: u8) -> u8 {
    return b ^ 3
}

// Complement entire sequence
fn complement(seq: &[u8]) -> [u8] {
    return seq.map(|b| b ^ 3)
}

// Reverse complement
fn reverse_complement(seq: &[u8]) -> [u8] {
    let rev = seq.reverse()
    return rev.map(|b| b ^ 3)
}

// Hamming distance between two sequences (simplified - no tuple destructuring)
fn hamming_distance(seq1: &[u8], seq2: &[u8], n: i32) -> i32 {
    var count = 0
    var i = 0
    while i < n {
        if seq1[i] != seq2[i] {
            count = count + 1
        }
        i = i + 1
    }
    return count
}

fn main() -> i32 {
    // Test sequence: ACGT = [0, 1, 2, 3]
    let seq = [0, 1, 2, 3]

    // Test shift
    let shifted = shift(&seq, 4, 2)

    // Test reverse
    let rev = reverse_seq(&seq)

    // Test complement
    let comp = complement(&seq)

    // Test reverse complement
    let rc = reverse_complement(&seq)

    return 0
}
